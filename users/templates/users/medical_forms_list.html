
{% extends 'users/base.html' %}

{% block users_title %}Medical Forms - CoralOffice{% endblock %}

{% block users_content %}
<div class="p-3 container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>Formularios Médicos Enviados</h2>
        <div style="display: flex; align-items: center; gap: 10px;">
            <span style="color: #666; font-size: 14px;">Total: {{ total_forms }} formularios</span>
        </div>
    </div>
    
    <!-- Search Form -->
    <div style="margin-bottom: 20px;">
        <form method="get" style="display: flex; gap: 10px; align-items: center;">
            <input type="text" name="search" value="{{ search_query }}" 
                   placeholder="Search by name, email, or phone..." 
                   style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
            <button type="submit" class="btn" style="background: #007bff; color: white; padding: 8px 16px;">Buscar</button>
            {% if search_query %}
                <a href="{% url 'users:medical_forms_list' %}" class="btn" style="background: #6c757d; color: white; padding: 8px 16px;">Clear</a>
            {% endif %}
        </form>
    </div>

    {% if search_query %}
        <p style="color: #666; margin-bottom: 15px;">
            Mostrando resultados para "{{ search_query }}" - {{ medical_forms.paginator.count }} formularios encontrados
        </p>
    {% endif %}

    {% if medical_forms %}
        <!-- Pagination Info -->
        <div style="margin-bottom: 15px; color: #666; font-size: 14px;">
            Mostrando {{ medical_forms.start_index }} - {{ medical_forms.end_index }} de {{ medical_forms.paginator.count }} formularios
        </div>

        <div style="margin-top: 20px;">
            {% for customer in medical_forms %}
            <div style="border: 1px solid #ddd; padding: 20px; margin-bottom: 15px; border-radius: 8px; background: white;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div style="flex: 1;">
                        <h4>{{ customer.first_name }} {{ customer.last_name }}</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 10px;">
                            <div>
                                <strong>Email:</strong> {{ customer.email|default:"No proporcionado" }}<br>
                                <strong>Teléfono:</strong> {{ customer.phone_number|default:"No proporcionado" }}<br>
                                <strong>País:</strong> {{ customer.country|default:"No especificado" }}
                            </div>
                            <div>
                                <strong>Idioma:</strong> {{ customer.get_language_display }}<br>
                                <strong>Fecha de nacimiento:</strong> {{ customer.birthday|default:"No proporcionada" }}<br>
                                <strong>Certificación:</strong> {{ customer.get_certification_level_display }}
                            </div>
                            <div>
                                <strong>Peso:</strong> {{ customer.weight|default:"No proporcionado" }} kg<br>
                                <strong>Altura:</strong> {{ customer.height|default:"No proporcionada" }} cm<br>
                                <strong>Talla de pie:</strong> {{ customer.foot_size|default:"No proporcionada" }} EU<br>
                                <strong>Capacidad para nadar:</strong> {{ customer.get_swimming_ability_display|default:"No proporcionada" }}
                            </div>
                        </div>

                        {% if customer.emergency_contact %}
                        <div style="margin-top: 15px;">
                            <strong>Contacto de emergencia:</strong> {{ customer.emergency_contact }}
                        </div>
                        {% endif %}

                        {% if customer.medical_conditions %}
                        <div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 5px;">
                            <strong>Información médica:</strong><br>
                            <span style="white-space: pre-line;">{{ customer.medical_conditions }}</span>
                        </div>
                        {% endif %}

                        <!-- Respuestas del cuestionario médico -->
                        {% if customer.medical_questionnaire_answers %}
                        <div style="margin-top: 15px;">
                            <button type="button" onclick="toggleMedicalAnswers({{ customer.id }})" 
                                    style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">
                                Ver respuestas del cuestionario médico
                            </button>


                            <div id="medical-answers-{{ customer.id }}" style="display: none; margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px; border: 1px solid #dee2e6;">
                                <h5 style="color: #dc3545; margin-bottom: 15px;">Respuestas del Cuestionario Médico</h5>

                                <!-- Pregunta 1: Pulmones/Respiración/Corazón/Sangre -->
                                <div class="medical-section">
                                    <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_1 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                        <strong>1. He tenido problemas con mis pulmones/respiración, corazón o sangre</strong>
                                        <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_1 %}#dc3545{% else %}#28a745{% endif %};">
                                            {% if customer.medical_questionnaire_answers.pregunta_1 %}SÍ{% else %}NO{% endif %}
                                        </span>
                                    </div>
                                    {% if customer.medical_questionnaire_answers.pregunta_1 %}
                                    <div style="margin-left: 20px; margin-bottom: 15px;">
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_1_1 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>1.1</strong> Cirugía de tórax, cirugía cardíaca, cirugía de válvulas cardíacas, dispositivo cardiovascular implantable, neumotórax
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_1_1 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_1_1 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_1_2 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>1.2</strong> Asma, sibilancias, alergias graves, fiebre del heno o vías respiratorias congestionadas en los últimos 12 meses
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_1_2 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_1_2 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_1_3 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>1.3</strong> Problemas con la función pulmonar o enfermedad torácica
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_1_3 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_1_3 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_1_4 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>1.4</strong> Presión arterial alta, o toma medicamentos para controlar la presión arterial
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_1_4 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_1_4 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>

                                <!-- Pregunta 2: Cerebro/Sistema Nervioso -->
                                <div class="medical-section">
                                    <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_2 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                        <strong>2. He tenido problemas con mi cerebro o sistema nervioso</strong>
                                        <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_2 %}#dc3545{% else %}#28a745{% endif %};">
                                            {% if customer.medical_questionnaire_answers.pregunta_2 %}SÍ{% else %}NO{% endif %}
                                        </span>
                                    </div>

                                    {% if customer.medical_questionnaire_answers.pregunta_2 %}
                                        <div style="margin-left: 20px; margin-bottom: 15px;">
                                            <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_2_1 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                                <strong>2.1</strong> Problemas de salud conductual, mentales o psicológicos
                                                <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_2_1 %}#dc3545{% else %}#28a745{% endif %};">
                                                    {% if customer.medical_questionnaire_answers.pregunta_2_1 %}SÍ{% else %}NO{% endif %}
                                                </span>
                                            </div>
                                            <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_2_2 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                                <strong>2.2</strong> Lesión en la cabeza con o sin pérdida de conciencia en los últimos 12 meses
                                                <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_2_2 %}#dc3545{% else %}#28a745{% endif %};">
                                                    {% if customer.medical_questionnaire_answers.pregunta_2_2 %}SÍ{% else %}NO{% endif %}
                                                </span>
                                            </div>
                                            <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_2_3 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                                <strong>2.3</strong> Problema persistente con el equilibrio, mareos, desmayos, convulsiones, ataques o epilepsia
                                                <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_2_3 %}#dc3545{% else %}#28a745{% endif %};">
                                                    {% if customer.medical_questionnaire_answers.pregunta_2_3 %}SÍ{% else %}NO{% endif %}
                                                </span>
                                            </div>
                                            <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_2_4 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                                <strong>2.4</strong> Incapacidad para realizar ejercicio moderadamente intenso
                                                <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_2_4 %}#dc3545{% else %}#28a745{% endif %};">
                                                    {% if customer.medical_questionnaire_answers.pregunta_2_4 %}SÍ{% else %}NO{% endif %}
                                                </span>
                                            </div>
                                        </div>
                                    {% endif %}
                                    </div>

                                    <!-- Pregunta 3: Estómago/Intestinos/Tripas -->
                                    <div class="medical-section">
                                        <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_3 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                            <strong>3. He tenido problemas con mi estómago, intestinos o tripas</strong>
                                            <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_3 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_3 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Pregunta 4: Músculos/Huesos/Articulaciones -->
                                    <div class="medical-section">
                                        <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_4 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                            <strong>4. He tenido problemas con mis músculos, huesos o articulaciones</strong>
                                            <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_4 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_4 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        {% if customer.medical_questionnaire_answers.pregunta_4 %}
                                        <div style="margin-left: 20px; margin-bottom: 15px;">
                                            <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_4_1 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                                <strong>4.1</strong> Lesión muscular, ósea o articular
                                                <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_4_1 %}#dc3545{% else %}#28a745{% endif %};">
                                                    {% if customer.medical_questionnaire_answers.pregunta_4_1 %}SÍ{% else %}NO{% endif %}
                                                </span>
                                            </div>
                                            <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_4_2 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                                <strong>4.2</strong> Problemas crónicos de espalda baja
                                                <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_4_2 %}#dc3545{% else %}#28a745{% endif %};">
                                                    {% if customer.medical_questionnaire_answers.pregunta_4_2 %}SÍ{% else %}NO{% endif %}
                                                </span>
                                            </div>
                                            <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_4_3 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                                <strong>4.3</strong> Limitación de la actividad física normal
                                                <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_4_3 %}#dc3545{% else %}#28a745{% endif %};">
                                                    {% if customer.medical_questionnaire_answers.pregunta_4_3 %}SÍ{% else %}NO{% endif %}
                                                </span>
                                            </div>
                                            <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_4_4 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                                <strong>4.4</strong> Limitación de movimiento
                                                <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_4_4 %}#dc3545{% else %}#28a745{% endif %};">
                                                    {% if customer.medical_questionnaire_answers.pregunta_4_4 %}SÍ{% else %}NO{% endif %}
                                                </span>
                                            </div>
                                        </div>
                                        {% endif %}
                                    </div>


                                <!-- Pregunta 5: Diabetes -->
                                <div class="medical-section">
                                    <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_5 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                        <strong>5. Tengo diabetes</strong>
                                        <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_5 %}#dc3545{% else %}#28a745{% endif %};">
                                            {% if customer.medical_questionnaire_answers.pregunta_5 %}SÍ{% else %}NO{% endif %}
                                        </span>
                                    </div>
                                </div>

                                <!-- Pregunta 6: Riñones/Vejiga/Intestinos -->
                                <div class="medical-section">
                                    <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_6 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                        <strong>6. He tenido problemas con mis riñones, vejiga o intestinos</strong>
                                        <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_6 %}#dc3545{% else %}#28a745{% endif %};">
                                            {% if customer.medical_questionnaire_answers.pregunta_6 %}SÍ{% else %}NO{% endif %}
                                        </span>
                                    </div>
                                    {% if customer.medical_questionnaire_answers.pregunta_6 %}
                                    <div style="margin-left: 20px; margin-bottom: 15px;">
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_6_1 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>6.1</strong> Tratamiento médico o quirúrgico del sistema digestivo en los últimos 12 meses
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_6_1 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_6_1 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_6_2 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>6.2</strong> Historial de problemas con enfermedad por descompresión y/o barotrauma
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_6_2 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_6_2 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_6_3 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>6.3</strong> Hernia
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_6_3 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_6_3 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_6_4 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>6.4</strong> Úlcera activa o cirugía de úlcera en los últimos 12 meses
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_6_4 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_6_4 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_6_5 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>6.5</strong> Diarrea frecuente o sangre en la orina
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_6_5 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_6_5 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>

                                <!-- Pregunta 7: Otros problemas médicos -->
                                <div class="medical-section">
                                    <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_7 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                        <strong>7. He tenido otros problemas médicos importantes</strong>
                                        <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_7 %}#dc3545{% else %}#28a745{% endif %};">
                                            {% if customer.medical_questionnaire_answers.pregunta_7 %}SÍ{% else %}NO{% endif %}
                                        </span>
                                    </div>
                                    {% if customer.medical_questionnaire_answers.pregunta_7 %}
                                    <div style="margin-left: 20px; margin-bottom: 15px;">
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_7_1 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>7.1</strong> Embarazada, o intentando quedar embarazada
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_7_1 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_7_1 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_7_2 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>7.2</strong> Más de 45 años de edad
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_7_2 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_7_2 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_7_3 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>7.3</strong> Dificultad para igualar oídos o dolor de senos nasales
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_7_3 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_7_3 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_7_4 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>7.4</strong> Cirugía de senos nasales en los últimos 12 meses
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_7_4 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_7_4 %}SÍ{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>

                                <!-- Question 8: Regular Medications -->
                                <div class="medical-section">
                                    <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_8 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                        <strong>8. I take medications on a regular basis (except birth control or malaria prevention)</strong>
                                        <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_8 %}#dc3545{% else %}#28a745{% endif %};">
                                            {% if customer.medical_questionnaire_answers.pregunta_8 %}YES{% else %}NO{% endif %}
                                        </span>
                                    </div>
                                    {% if customer.medical_questionnaire_answers.pregunta_8 %}
                                    <div style="margin-left: 20px; margin-bottom: 15px;">
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_8_1 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>8.1</strong> Prescription or over-the-counter medications within the last 12 months
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_8_1 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_8_1 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_8_2 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>8.2</strong> Previous adverse reaction to any medication
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_8_2 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_8_2 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_8_3 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>8.3</strong> Currently under the care of a physician
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_8_3 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_8_3 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_8_4 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>8.4</strong> Have been advised against participating in sports or exercise
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_8_4 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_8_4 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_8_5 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>8.5</strong> Been a patient in a hospital, surgical or emergency facility within the last 12 months
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_8_5 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_8_5 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>

                                <!-- Question 9: Recreational Drugs -->
                                <div class="medical-section">
                                    <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_9 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                        <strong>9. I have had problems with recreational drugs</strong>
                                        <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_9 %}#dc3545{% else %}#28a745{% endif %};">
                                            {% if customer.medical_questionnaire_answers.pregunta_9 %}YES{% else %}NO{% endif %}
                                        </span>
                                    </div>
                                    {% if customer.medical_questionnaire_answers.pregunta_9 %}
                                    <div style="margin-left: 20px; margin-bottom: 15px;">
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_9_1 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>9.1</strong> Used tobacco products within the last 12 months
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_9_1 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_9_1 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_9_2 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>9.2</strong> Used alcohol, prescription or over-the-counter drugs within the last 12 months
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_9_2 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_9_2 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_9_3 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>9.3</strong> Been told I have a drinking problem
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_9_3 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_9_3 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_9_4 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>9.4</strong> Failed a drug or alcohol test required by an employer
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_9_4 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_9_4 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_9_5 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>9.5</strong> Been arrested for driving while under the influence of alcohol or drugs
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_9_5 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_9_5 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                        <div style="margin-bottom: 8px; padding: 8px; background: {% if customer.medical_questionnaire_answers.pregunta_9_6 %}#ffe6e6{% else %}#f8f9fa{% endif %};">
                                            <strong>9.6</strong> Been in treatment for alcohol or drug use
                                            <span style="float: right; color: {% if customer.medical_questionnaire_answers.pregunta_9_6 %}#dc3545{% else %}#28a745{% endif %};">
                                                {% if customer.medical_questionnaire_answers.pregunta_9_6 %}YES{% else %}NO{% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>

                                <!-- Question 10: Marijuana/Cannabis -->
                                <div class="medical-section">
                                    <div class="question-header" style="background: {% if customer.medical_questionnaire_answers.pregunta_10 %}#ffe6e6{% else %}#e6f7e6{% endif %}; padding: 10px; margin-bottom: 10px; border-radius: 5px;">
                                        <strong>10. I have used marijuana/cannabis in any form within the last 12 months</strong>
                                        <span style="float: right; font-weight: bold; color: {% if customer.medical_questionnaire_answers.pregunta_10 %}#dc3545{% else %}#28a745{% endif %};">
                                            {% if customer.medical_questionnaire_answers.pregunta_10 %}YES{% else %}NO{% endif %}
                                        </span>
                                    </div>
                                </div>

                                {% if customer.signature %}
                                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                                    <h6>Firma digital:</h6>
                                    <img src="{{ customer.signature.url }}" alt="Customer Signature" style="max-width: 300px; border: 1px solid #ddd;">
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}

                        <div style="margin-top: 15px; font-size: 12px; color: #666;">
                            <strong>Enviado:</strong> {{ customer.created_at|date:"F j, Y, g:i A" }}
                        </div>
                    </div>

                    <div style="margin-left: 20px; display: flex; flex-direction: column; gap: 5px;">
                        <a href="{% url 'users:edit_customer' customer.id %}" class="btn btn-success" style="padding: 5px 10px; font-size: 12px; text-align: center;">Editar</a>
                        <a href="{% url 'users:customer_activity_history' customer.id %}" class="btn btn-info" style="padding: 5px 10px; font-size: 12px; text-align: center;">Historial</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    <!-- Pagination -->
        {% if medical_forms.has_other_pages %}
        <div style="display: flex; justify-content: center; align-items: center; margin: 30px 0; gap: 10px;">
            {% if medical_forms.has_previous %}
                <a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}" class="btn" style="background: #6c757d; color: white; padding: 8px 12px;">Primera</a>
                <a href="?page={{ medical_forms.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" class="btn" style="background: #007bff; color: white; padding: 8px 12px;">Anterior</a>
            {% endif %}

            <span style="margin: 0 15px; color: #666;">
                Página {{ medical_forms.number }} de {{ medical_forms.paginator.num_pages }}
            </span>

            {% if medical_forms.has_next %}
                <a href="?page={{ medical_forms.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" class="btn" style="background: #007bff; color: white; padding: 8px 12px;">Siguiente</a>
                <a href="?page={{ medical_forms.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}" class="btn" style="background: #6c757d; color: white; padding: 8px 12px;">Última</a>
            {% endif %}
        </div>
        {% endif %}
    {% else %}
        <div style="text-align: center; padding: 40px; color: #666;">
            {% if search_query %}
                <p>No medical forms found matching "{{ search_query }}".</p>
                <a href="{% url 'users:medical_forms_list' %}" class="btn" style="background: #007bff; color: white;">Show All Forms</a>
            {% else %}
                <p>No medical forms have been submitted yet.</p>
                <p>Share the medical form link with customers:</p>
                <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-top: 10px;">
                    <code>{{ request.build_absolute_uri }}{% url 'users:medical_form' %}</code>
                </div>
            {% endif %}
        </div>
    {% endif %}

    <div style="margin-top: 30px;">
        <a href="{% url 'users:diving_center_dashboard' %}" class="btn btn-secondary">Volver</a>
    </div>
</div>

<script>
function toggleMedicalAnswers(customerId) {
    const answersDiv = document.getElementById('medical-answers-' + customerId);
    if (answersDiv.style.display === 'none') {
        answersDiv.style.display = 'block';
    } else {
        answersDiv.style.display = 'none';
    }
}
</script>
{% endblock %}
